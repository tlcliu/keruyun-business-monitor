# 客如云智享版实时营业报告程序

## 一、功能说明

本程序是一个基于**客如云智享版API**和Python Tkinter的桌面应用程序，用于实时获取指定店铺的营业数据，并将数据发送到飞书机器人。主要功能包括：
1. **定时获取营业数据**：程序会根据当前时间调整数据刷新频率，在营业高峰期（10:30 - 14:00 和 17:00 - 23:00）每分钟刷新一次数据，其他时间段每3分钟刷新一次。
2. **数据处理与分析**：从客如云API获取堂食订单数据，计算总订单数、已结账营业额、已结账营业收入、未结账订单数和未结账收入等指标。
3. **数据显示**：在程序窗口中显示实时营业报告，每小时清空一次窗口显示内容。
4. **数据推送**：将更新后的营业报告发送到飞书机器人。
5. **程序控制**：提供开始、停止和退出程序的按钮，方便用户操作。

## 二、使用说明

### 2.1 环境准备
- **Python环境**：确保你已经安装了Python 3.x版本。
- **依赖库**：本程序依赖于以下Python库，请使用以下命令安装：
```bash
pip install requests tkinter
```
### 2.2 配置参数
在代码中，有一些固定参数需要根据实际客如云智享版账号信息进行修改：
# 固定参数
```
FIXED_TOKEN = "TOKEN" # 请替换为客如云智享版API的Token
FIXED_SHOP_ID = "00000000" # 请替换为真实的店铺ID
FIXED_SHOP_NAME = "某某餐饮店" # 请替换为真实的店铺名称
FIXED_APP_KEY = "APP_KEY"  # 请替换为客如云智享版API的App Key
FIXED_APP_SECRET = "APP_SECRET"  # 请替换为客如云智享版API的App Secret
FIXED_FEISHU_WEBHOOK = "FEISHU_WEBHOOK"  # 请替换为真实的飞书机器人地址
```
### 2.3 运行程序
将修改后的代码保存为 report_robot_kry.py，然后在命令行中运行以下命令：
```
bash
python report_robot_kry.py
```
### 2.4 程序界面操作
开始获取数据：点击该按钮，程序开始定时获取营业数据，并在窗口中显示实时报告。
停止：点击该按钮，程序停止获取数据。
退出：点击该按钮，程序会提示确认退出。如果程序正在运行中，会询问是否确认退出。
###2.5 日志查看
程序会在操作日志框中显示操作信息，包括数据获取状态、飞书发送状态等。
## 三、注意事项
请确保你的网络连接正常，以便程序能够正常访问客如云 API 和飞书机器人。
由于 API 请求可能会受到限制，程序中添加了随机延迟，避免请求过于频繁。
如果程序出现异常，请查看操作日志框中的错误信息，并根据提示进行处理。
本程序仅支持客如云智享版系统，其他版本可能需要调整 API 参数和请求格式。
## 四、许可证
本项目采用 MIT License，允许自由使用、修改和分发，但需保留原作者版权声明。详情见 LICENSE 文件。
## 五、贡献
欢迎提交问题报告或拉取请求来改进本项目。如需重大修改，请先开一个 Issue 讨论。
